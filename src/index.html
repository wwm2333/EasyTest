<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Page Title</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <style>
        #div{
            width:100px;
            height: 100px;
            background-color: brown;
            position: absolute;
            left:0px;
            top:0px;
            }
    </style>
    <script src="/socket.io/socket.io.js"></script>
    <script>
        window.onload=function(){
            var oBtn=document.getElementById('btn');
            var oName=document.getElementById('name');
            var oDiv=document.getElementById('div');
            var socket =null; 

            oBtn.onclick=function(){
                socket=io('http://localhost:8888');
                socket.on('news', function (data) {
                console.log(data);
                oName.innerHTML=data.hello;
                socket.emit('my other event', { my: 'data' });
            
                socket.on('another',function(data){
                    alert(data);
                })
                //拖拽
                var disX=0;
                var disY=0;
                var X=0;
                var Y=0;
                oDiv.ondragstart=function(ev){
                    var ev=ev||event;
                    X=ev.clientX;
                    Y=ev.clientY;
                    disX=X-oDiv.offsetLeft;
                    disY=Y-oDiv.offsetTop;
                }
                
                oDiv.ondrag=function(ev){
                    var ev=ev||event;
                    oDiv.style.left=ev.clientX-disX+"px";
                    oDiv.style.top=ev.clientY-disY+"px";
                    if( ev.clientX-disX>0&& ev.clientY-disY>0){
                        socket.emit('move',{left:oDiv.style.left,top:oDiv.style.top});
                    }
                }
             oDiv.ondragend=function(ev){
                var ev=ev||event;
                oDiv.style.left=ev.clientX-disX+"px";
                oDiv.style.top=ev.clientY-disY+"px";
                socket.emit('move',{left:oDiv.style.left,top:oDiv.style.top});
             }
                socket.on('setpossion',function(data){
                    console.log(data.left,data.top);
                    oDiv.style.left=data.left;
                    oDiv.style.top=data.top;
                })
                });
            

            }
        }
    
    </script>
<script>
    //桌面提醒
    function notifyMe() {
        // 先检查浏览器是否支持
        if (!("Notification" in window)) {
            alert("This browser does not support desktop notification");
        }
        // 检查用户是否同意接受通知
        else if (Notification.permission === "granted") {
            // If it's okay let's create a notification
            var notification = new Notification("Hi there!");
        }
        // 否则我们需要向用户获取权限
        else if (Notification.permission !== 'denied') {
            Notification.requestPermission(function (permission) {
            // 如果用户同意，就可以向他们发送通知
            if (permission === "granted") {
                var notification = new Notification("Hi there!");
            }
        });
    }
    // 最后，如果执行到这里，说明用户已经拒绝对相关通知进行授权
    // 出于尊重，我们不应该再打扰他们了
    }       
</script>
</head>
<body>
    <h1>Hello,<span id="name"></span></h1>
    <input type="file"/>
   <input type="button" id="btn" value="建立socket链接" />

  <div id='div' draggable="true"></div>

  <div contenteditable="true" value="内容变成可输入"></div>
  <input type="text" x-webkit-speech /> <!--语音输入：火狐不支持-->
  <button onclick="notifyMe()">Notify me!</button>
</body>
</html>


